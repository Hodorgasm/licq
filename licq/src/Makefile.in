#
# Make any modifications to Makefile.in *NOT* Makefile, as it will be
# overwritten by configure.
#

SHELL = /bin/sh

srcdir = @srcdir@
top_srcdir = @top_srcdir@

prefix = @prefix@
exec_prefix = @exec_prefix@

bindir = @bindir@
mandir = @mandir@

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
MKINSTALLDIRS = $(top_srcdir)/mkinstalldirs

CC	 = @CC@
CFLAGS	 = @CFLAGS@
CXX	 = @CXX@
CXXFLAGS = @CXXFLAGS@ -Wall
CPPFLAGS = -I$(srcdir) -I$(top_srcdir) -I$(srcdir)/inc -I$(srcdir)/daemon \
	         @CPPFLAGS@ -DINSTALL_PREFIX=\"@prefix@\" @DEFS@ \
           @SOCKS_INCDIR@
LDFLAGS  = @SOCKS_LIBDIR@ @LDFLAGS@
LDLIBS   = @LIBS@ @SOCKS_LIBS@
STRIP    = @PROG_STRIP@
SIZE     = @PROG_SIZE@

OBJECTS	= obj/licq.o obj/main.o 

SUFFIXES = .o .c .cpp

obj/%.o: %.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $@
obj/%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) -c $< -o $@


.PHONY: all clean distclean install
all: licq

dep:
	g++ $(CPPFLAGS) -MM *.cpp > Makefile.dep

Makefile.dep:
	touch Makefile.dep
	$(MAKE) dep

clean:
	$(RM) licq core *.o *.core obj/*.o Makefile.dep
	( cd daemon && $(MAKE) clean )

distclean: clean
	$(RM) *~ Makefile tags
	( cd daemon && $(MAKE) distclean )

install: all
	$(MKINSTALLDIRS) $(bindir)
	$(INSTALL_PROGRAM) $(srcdir)/licq $(bindir)
	$(STRIP) $(bindir)/licq

licq-daemon:
	( cd daemon && $(MAKE) licq-daemon.a )

licq: licq-daemon $(OBJECTS)
	$(CXX) $(CXXFLAGS) -o $@ $(OBJECTS) $(srcdir)/daemon/licq-daemon.a $(LDFLAGS) $(LDLIBS)
	$(SIZE) $@

# Automatically generated depends - made with
# g++ -I$(CPPFLAGS) -MM *.cpp

include Makefile.dep

