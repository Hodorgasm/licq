#
# Make any modifications to Makefile.in *NOT* Makefile, as it will be
# overwritten by configure.
#

SHELL = /bin/sh

srcdir = @srcdir@
top_srcdir = @top_srcdir@

prefix = @prefix@
exec_prefix = @exec_prefix@

bindir = @bindir@
mandir = @mandir@

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
MKINSTALLDIRS = $(top_srcdir)/mkinstalldirs

CC	 = @CC@
CFLAGS	 = @CFLAGS@
CXX	 = @CXX@
CXXFLAGS = @CXXFLAGS@ -Wall
CPPFLAGS = @CPPFLAGS@ -I$(srcdir) -I$(top_srcdir) -I$(srcdir)/inc @DEFS@ \
	   -I$(srcdir)/daemon -DINSTALL_DIR="\"@prefix@\"" @SOCKS_INCDIR@
LDFLAGS  = @SOCKS_LIBDIR@ -rdynamic
LDLIBS   = @LIBS@ @SOCKS_LIBS@
STRIP    = @PROG_STRIP@
SIZE     = @PROG_SIZE@

OBJECTS	= licq.o main.o 

SUFFIXES = .o .c .cpp

%.o: %.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<
%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) -c $<


.PHONY: all clean distclean install
all: licq-daemon.a licq

dep:
	g++ $(CPPFLAGS) -MM *.cpp > Makefile.dep

clean:
	$(RM) licq core *.o *.core
	( cd daemon && $(MAKE) clean )

distclean: clean
	$(RM) *~ Makefile tags
	( cd daemon && $(MAKE) distclean )

install: all
	$(MKINSTALLDIRS) $(bindir)
	$(INSTALL_PROGRAM) $(srcdir)/licq $(bindir)
	$(STRIP) $(bindir)/licq

licq-daemon.a:
	( cd daemon && $(MAKE) licq-daemon.a )

licq: $(OBJECTS) $(srcdir)/daemon/licq-daemon.a
	$(CXX) $(CXXFLAGS) -o $@ $^ $(LDFLAGS) $(LDLIBS)
	$(SIZE) $@

# Automatically generated depends - made with
# g++ -I$(CPPFLAGS) -MM *.cpp

include Makefile.dep

