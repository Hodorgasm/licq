#
# Make any modifications to Makefile.in *NOT* Makefile, as it will be
# overwritten by configure.
#

SHELL = /bin/sh

srcdir = @srcdir@
top_srcdir = @top_srcdir@

prefix = @prefix@
exec_prefix = @exec_prefix@

bindir = @bindir@
plugindir = @libdir@/licq
mandir = @mandir@

PACKAGE = @PACKAGE@
VERSION = @VERSION@
localedir = @LOCALEDATADIR@
LC_ALL = @LC_ALL@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
MKINSTALLDIRS = $(top_srcdir)/mkinstalldirs

licq_incdir = ../../../src/inc

CC	 = @CC@
CFLAGS	 = @CFLAGS@
CXX	 = @CXX@
CXXFLAGS = -fno-rtti -fno-exceptions @CXXFLAGS@ @X_CFLAGS@ @QT_INCLUDES@ @KDE_INCLUDES@
CPPFLAGS = -Wall -fPIC -DPIC -D_REENTRANT @CPPFLAGS@ -I$(srcdir) -I$(top_srcdir) -I$(licq_incdir) -I$(top_srcdir)/intl @DEFS@ -DLOCALEDIR="\"$(localedir)\"" @X_CFLAGS@ @QT_INCLUDES@ @KDE_INCLUDES@
LDFLAGS  = -shared -nostdlib @X_LIBS@ @QT_LDFLAGS@ @KDE_LDFLAGS@
LDLIBS   = @INTLLIBS@ -lqt @X_PRE_LIBS@ -lX11 -lXext @XSS_LIBS@ @X_EXTRA_LIBS@ @INTLLIBS@ @KDE_LIBS@
MOC      = @QT_MOC@
STRIP    = @PROG_STRIP@
SIZE     = @PROG_SIZE@
 

OBJECTS	= obj/icqfunctions.o obj/outputwin.o obj/awaymsgdlg.o obj/adduserdlg.o \
          obj/authuserdlg.o obj/userbox.o obj/licqgui.o obj/mainwin.o \
          obj/mledit.o  obj/searchuserdlg.o obj/messagebox.o obj/chatdlg.o \
          obj/optionsdlg.o obj/ewidgets.o obj/chatacceptdlg.o \
          obj/fileacceptdlg.o obj/filedlg.o obj/showawaymsgdlg.o obj/sigman.o \
          obj/skin.o obj/utilitydlg.o obj/wharf.o obj/editgrp.o \
          obj/skinbrowser.o obj/registeruser.o

METAOBJ	= 

SUFFIXES = .o .c .cpp

# QT Meta header files
moc/moc_%.h: %.h
	$(MOC) -o $@ $<
 
# Regular c/c++ files
obj/%.o: %.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $@
obj/%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) -c $< -o $@

.PHONY: all clean distclean install
all: licq_qt-gui.so

mocs:
	for i in `grep -l "Q_OBJECT" *.h`; do $(MOC) -o moc/moc_$$i $$i; done

dep:
	g++ $(CPPFLAGS) -MM *.cpp | sed -e 's/^/obj\//' | sed -e 's/^obj\/ / /' > Makefile.dep

clean:
	$(RM) core obj/*.o *.core moc/* licq_qt-gui.so

distclean: clean
	$(RM) *~ Makefile tags

install: all
	$(MKINSTALLDIRS) $(plugindir)
	$(INSTALL_PROGRAM) $(srcdir)/licq_qt-gui.so $(plugindir)
	$(STRIP) $(plugindir)/licq_qt-gui.so

licq_qt-gui.so: $(OBJECTS) $(METAOBJ)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(LDFLAGS) $(LDLIBS)


# Automatically generated depends - made with
# g++ -I$(CPPFLAGS) -MM *.cpp

include Makefile.dep
