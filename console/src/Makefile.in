#
# Make any modifications to Makefile.in *NOT* Makefile, as it will be
# overwritten by configure.
#

SHELL = /bin/sh

srcdir = @srcdir@
top_srcdir = @top_srcdir@

prefix = @prefix@
exec_prefix = @exec_prefix@

bindir = @bindir@
plugindir = @libdir@/licq
mandir = @mandir@

PACKAGE = @PACKAGE@
VERSION = @VERSION@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
MKINSTALLDIRS = $(top_srcdir)/mkinstalldirs

licq_incdir = @LICQ_INCLUDES@

CC	 = @CC@
CFLAGS	 = @CFLAGS@
CXX	 = @CXX@
CXXFLAGS = -fno-rtti -fno-exceptions @CXXFLAGS@ 
CPPFLAGS = -Wall -fPIC -DPIC -D_REENTRANT -I$(srcdir) -I$(top_srcdir) \
           -I$(licq_incdir) @CPPFLAGS@ @DEFS@
LDFLAGS  = -shared -nostdlib
LDLIBS   = -lncurses
STRIP    = @PROG_STRIP@
SIZE     = @PROG_SIZE@
 

OBJECTS	= obj/main.o obj/window.o obj/console.o obj/console_tab.o \
          obj/console_menu.o obj/eventdesc.o

SUFFIXES = .o .c .cpp

# Regular c/c++ files
obj/%.o: %.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $@
obj/%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) -c $< -o $@

.PHONY: all clean distclean install
all: licq_console.so

dep:
	g++ $(CPPFLAGS) -MM *.cpp | sed -e 's/^/obj\//' | sed -e 's/^obj\/ / /' > Makefile.dep

Makefile.dep:
	touch Makefile.dep
	make dep

clean:
	$(RM) core obj/*.o *.core moc/moc_* licq_qt-gui.so Makefile.dep

distclean: clean
	$(RM) *~ Makefile tags

install: all
	$(MKINSTALLDIRS) $(plugindir)
	$(INSTALL_PROGRAM) $(srcdir)/licq_console.so $(plugindir)
	$(STRIP) $(plugindir)/licq_console.so

licq_console.so: $(OBJECTS) $(METAOBJ)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(LDFLAGS) $(LDLIBS)


# Automatically generated depends - made with
# g++ -I$(CPPFLAGS) -MM *.cpp

include Makefile.dep
